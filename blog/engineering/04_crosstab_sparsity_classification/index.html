<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jitin Kapila">
<meta name="dcterms.date" content="2023-01-03">
<meta name="description" content="Can our metric help us in making a classification problem work better ?">

<title>CrossTab Sparsity for Classification – Jitin Kapila</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../img/jk-logo.svg" rel="icon" type="image/svg+xml">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-626b0fff7b0ff2cc043be631a594889b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-1c95faf5db9766d5801f2e48e112ecf1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script defer="" src="https://cloud.umami.is/script.js" data-website-id="aeaaf854-d53a-45ab-83d5-1963c96af264"></script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NHFL6KB2FQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NHFL6KB2FQ');
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
      "@id": "https://jitinkapila.com/#person",
      "name": "Jitin Kapila",
      "alternateName": "The AI Architect",
      "description": "AI Strategy Consultant and Acting CTO with 14 years of enterprise AI implementation experience across Fortune 500 companies",
      "url": "https://jitinkapila.com",
      "image": "https://jitinkapila.com/display_image.jpg",
      "jobTitle": "AI Strategy Consultant & Acting CTO",
      "worksFor": {
        "@type": "Organization",
        "name": "Independent Consultant"
      },
      "knowsAbout": [
        "Artificial Intelligence Strategy",
        "Enterprise Architecture",
        "Predictive Analytics",
        "Machine Learning",
        "Digital Transformation",
        "Decision-Focused AI"
      ],
      "alumniOf": {
        "@type": "EducationalOrganization",
        "name": "Mechanical Engineering & Applied Mathematics"
      },
      "sameAs": [
        "https://linkedin.com/in/jitinkapila",
        "https://github.com/jkapila",
        "https://x.com/jitinkapila",
        "https://youtube.com/@jitinkapila",
        "https://aicrosscurrent.substack.com/",
        "https://instagram.com/jitinkapila"
      ]
    },
    {
      "@type": "ProfessionalService",
      "@id": "https://jitinkapila.com/#service",
      "name": "The AI Architect - AI Strategy Consulting",
      "description": "AI Strategy Consulting and Enterprise AI Transformation for Fortune 500 companies. Specializing in cross-industry pattern recognition and decision-first AI implementation.",
      "url": "https://jitinkapila.com",
      "logo": "https://jitinkapila.com/favicon-32x32.png",
      "image": "https://jitinkapila.com/display_image.jpg",
      "founder": {
        "@id": "https://jitinkapila.com/#person"
      },
      "provider": {
        "@id": "https://jitinkapila.com/#person"
      },
      "areaServed": {
        "@type": "Place",
        "name": "Worldwide"
      },
      "serviceType": [
        "AI Strategy Consulting",
        "Enterprise AI Architecture",
        "AI Transformation Roadmaps",
        "Acting CTO Services",
        "AI Training & Coaching"
      ],
      "priceRange": "$$$$"
    },
    {
      "@type": "Course",
      "@id": "https://jitinkapila.com/bootcamp.html#course",
      "name": "The AI Architect Protocol",
      "description": "A 3-day intensive bootcamp that transforms how enterprise leaders think about AI strategy. Master the OLCD Protocol, AI-ART Matrix, and Blueprint Methodology.",
      "provider": {
        "@id": "https://jitinkapila.com/#person"
      },
      "url": "https://jitinkapila.com/bootcamp.html",
      "courseMode": "Online",
      "educationalLevel": "Executive",
      "educationalCredentialAwarded": "Certificate of Completion",
      "numberOfCredits": "3 days",
      "timeRequired": "P3D",
      "inLanguage": "en",
      "coursePrerequisites": "Director or above at enterprise organization with AI strategy responsibility",
      "teaches": [
        "OLCD Protocol (Observe → Learn → Create → Deploy)",
        "AI-ART Matrix framework",
        "Blueprint Methodology for AI transformation",
        "Cross-industry pattern recognition",
        "Decision-first AI implementation"
      ],
      "hasCourseInstance": {
        "@type": "CourseInstance",
        "courseMode": "Online",
        "courseWorkload": "P3D",
        "instructor": {
          "@id": "https://jitinkapila.com/#person"
        }
      },
      "offers": {
        "@type": "Offer",
        "price": "7999",
        "priceCurrency": "INR",
        "availability": "https://schema.org/LimitedAvailability",
        "validFrom": "2025-01-01",
        "url": "https://jitinkapila.com/bootcamp.html",
        "seller": {
          "@id": "https://jitinkapila.com/#person"
        },
        "priceValidUntil": "2025-12-31",
        "description": "Limited to 20 seats per cohort. Includes live sessions, framework library, 90-day roadmap, and lifetime access."
      }
    },
    {
      "@type": "WebSite",
      "@id": "https://jitinkapila.com/#website",
      "url": "https://jitinkapila.com",
      "name": "Jitin Kapila | The AI Architect",
      "description": "AI Strategy & Enterprise Architecture for Fortune 500 Leaders",
      "publisher": {
        "@id": "https://jitinkapila.com/#person"
      },
      "inLanguage": "en"
    }
  ]
}
</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="CrossTab Sparsity for Classification – Jitin Kapila">
<meta property="og:description" content="Can our metric help us in making a classification problem work better ?">
<meta property="og:image" content="https://jitinkapila.com/blog/engineering/04_crosstab_sparsity_classification/crossroad-unsplash.jpg">
<meta property="og:site_name" content="Jitin Kapila">
<meta name="twitter:title" content="CrossTab Sparsity for Classification – Jitin Kapila">
<meta name="twitter:description" content="Can our metric help us in making a classification problem work better ?">
<meta name="twitter:image" content="https://jitinkapila.com/blog/engineering/04_crosstab_sparsity_classification/crossroad-unsplash.jpg">
<meta name="twitter:creator" content="@jitinkapila">
<meta name="twitter:site" content="@jitinkapila">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/jk-logo.svg" alt="" class="navbar-logo light-content">
    <img src="../../../img/jk-logo.svg" alt="" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">JITIN KAPILA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../cohort/index.html"> 
<span class="menu-text">Courses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <div id="quarto-announcement" data-announcement-id="f676454d1f753fa979410f19d0a26cb4" class="alert alert-primary hidden"><i class="bi bi-info-circle quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p><strong>Alert</strong> - New course dates to be announced soon! Stay Tuned!</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-a-journey-into-data" id="toc-introduction-a-journey-into-data" class="nav-link active" data-scroll-target="#introduction-a-journey-into-data">Introduction: A Journey into Data</a></li>
  <li><a href="#the-power-of-crosstab-sparsity" id="toc-the-power-of-crosstab-sparsity" class="nav-link" data-scroll-target="#the-power-of-crosstab-sparsity">The Power of CrossTab Sparsity</a>
  <ul class="collapse">
  <li><a href="#what-is-crosstab-sparsity" id="toc-what-is-crosstab-sparsity" class="nav-link" data-scroll-target="#what-is-crosstab-sparsity">What is CrossTab Sparsity?</a></li>
  </ul></li>
  <li><a href="#data-overview-our-data-people-at-work-here" id="toc-data-overview-our-data-people-at-work-here" class="nav-link" data-scroll-target="#data-overview-our-data-people-at-work-here">Data Overview: Our Data People at work here</a>
  <ul class="collapse">
  <li><a href="#the-datasets" id="toc-the-datasets" class="nav-link" data-scroll-target="#the-datasets">The Datasets</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda-setting-the-stage" id="toc-exploratory-data-analysis-eda-setting-the-stage" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda-setting-the-stage">Exploratory Data Analysis (EDA): Setting the Stage</a>
  <ul class="collapse">
  <li><a href="#eda-for-obesity-data" id="toc-eda-for-obesity-data" class="nav-link" data-scroll-target="#eda-for-obesity-data">EDA for Obesity Data</a></li>
  </ul></li>
  <li><a href="#model-creation-establishing-a-baseline" id="toc-model-creation-establishing-a-baseline" class="nav-link" data-scroll-target="#model-creation-establishing-a-baseline">Model Creation: Establishing a Baseline</a>
  <ul class="collapse">
  <li><a href="#evaluating-model-performance" id="toc-evaluating-model-performance" class="nav-link" data-scroll-target="#evaluating-model-performance">Evaluating Model Performance</a></li>
  </ul></li>
  <li><a href="#looking-for-some-improvments" id="toc-looking-for-some-improvments" class="nav-link" data-scroll-target="#looking-for-some-improvments">Looking for some <em>Improvments!</em></a>
  <ul class="collapse">
  <li><a href="#feature-selection-using-crosstab-sparsity" id="toc-feature-selection-using-crosstab-sparsity" class="nav-link" data-scroll-target="#feature-selection-using-crosstab-sparsity">Feature Selection Using CrossTab Sparsity</a></li>
  <li><a href="#standared-steps-for-feature-selection" id="toc-standared-steps-for-feature-selection" class="nav-link" data-scroll-target="#standared-steps-for-feature-selection">Standared Steps for Feature Selection</a></li>
  <li><a href="#and-drum-rolls-pelase" id="toc-and-drum-rolls-pelase" class="nav-link" data-scroll-target="#and-drum-rolls-pelase">And Drum Rolls pelase!!!</a></li>
  </ul></li>
  <li><a href="#impact-on-model-accuracy" id="toc-impact-on-model-accuracy" class="nav-link" data-scroll-target="#impact-on-model-accuracy">Impact on Model Accuracy</a>
  <ul class="collapse">
  <li><a href="#results-and-discussion-unveiling-insights" id="toc-results-and-discussion-unveiling-insights" class="nav-link" data-scroll-target="#results-and-discussion-unveiling-insights">Results and Discussion: Unveiling Insights</a></li>
  </ul></li>
  <li><a href="#conclusion-the-road-ahead" id="toc-conclusion-the-road-ahead" class="nav-link" data-scroll-target="#conclusion-the-road-ahead">Conclusion: The Road Ahead</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CrossTab Sparsity for Classification</h1>
  <div class="quarto-categories">
    <div class="quarto-category">classification</div>
    <div class="quarto-category">metric</div>
    <div class="quarto-category">feature selection</div>
  </div>
  </div>

<div>
  <div class="description">
    Can our metric help us in making a classification problem work better ?
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jitin Kapila </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 3, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><a href="crossroad-unsplash-thumb.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Cross Roads where everyone meets!"><img src="crossroad-unsplash-thumb.jpg" class="img-fluid figure-img" alt="Cross Roads where everyone meets!"></a></p>
<figcaption class="margin-caption">Cross Roads where everyone meets!</figcaption>
</figure>
</div>
<section id="introduction-a-journey-into-data" class="level1">
<h1>Introduction: A Journey into Data</h1>
<p>Picture this: you’re standing on the icy shores of Antarctica, the wind whipping around you as you watch a colony of Palmer Penguins waddling about, oblivious to the data detective work you’re about to embark on. As a data science architect, you’re not just an observer; you’re a sleuth armed with algorithms and insights, ready to unravel the mysteries hidden within data. Today, we’ll transform raw numbers into powerful narratives using CrossTab Sparsity as our guiding compass. This blog post will demonstrate how this metric can revolutionize classification tasks, shedding light on many fascinating datasets—the charming Palmer Penguins and the serious Obesity, Credit cards data and many more.</p>
</section>
<section id="the-power-of-crosstab-sparsity" class="level1">
<h1>The Power of CrossTab Sparsity</h1>
<section id="what-is-crosstab-sparsity" class="level3">
<h3 class="anchored" data-anchor-id="what-is-crosstab-sparsity">What is CrossTab Sparsity?</h3>
<p>CrossTab Sparsity isn’t just a fancy term that sounds good at dinner parties; it’s a statistical measure that helps us peer into the intricate relationships between categorical variables. Imagine it as a magnifying glass that reveals how different categories interact within a contingency table. Understanding these interactions is crucial in classification tasks, where the right features can make or break your model (and your day).</p>
<p><strong>Why Does It Matter?</strong></p>
<p>In the world of data science, especially in classification, selecting relevant features is like picking the right ingredients for a gourmet meal—get it wrong, and you might end up with something unpalatable. CrossTab Sparsity helps us achieve this by:</p>
<ul>
<li>Highlighting Relationships: It’s like having a friend who always points out when two people are meant to be together—understanding how features interact with the target variable.</li>
<li>Streamlining Models: Reducing complexity by focusing on significant features means less time spent untangling spaghetti code.</li>
<li>Enhancing Interpretability: Making models easier to understand and explain to stakeholders is like translating tech jargon into plain English—everyone appreciates that!</li>
</ul>
</section>
</section>
<section id="data-overview-our-data-people-at-work-here" class="level1">
<h1>Data Overview: Our Data People at work here</h1>
<section id="the-datasets" class="level3">
<h3 class="anchored" data-anchor-id="the-datasets">The Datasets</h3>
<p>Data 1: <a href="https://archive.ics.uci.edu/dataset/544/estimation+of+obesity+levels+based+on+eating+habits+and+physical+condition">Estimation of Obesity Levels Based On Eating Habits and Physical Condition</a></p>
<p><em>Little bit about the data:</em> This dataset, shared on 8/26/2019, looks at obesity levels in people from Mexico, Peru, and Colombia based on their eating habits and physical health. It includes 2,111 records with 16 features, and classifies individuals into different obesity levels, from insufficient weight to obesity type III. Most of the data (77%) was created using a tool, while the rest (23%) was collected directly from users online.</p>
<p>Data 2: <a href="https://archive.ics.uci.edu/dataset/697/predict+students+dropout+and+academic+success">Predict Students’ Dropout and Academic Success</a></p>
<p><em>Little bit about the data:</em> This dataset, shared on 12/12/2021, looks at factors like students’ backgrounds, academic path, and socio-economic status to predict whether they’ll drop out or succeed in their studies. With 4,424 records across 36 features, it covers students from different undergrad programs. The goal is to use machine learning to spot at-risk students early, so schools can offer support. The data has been cleaned and doesn’t have any missing values. It’s a classification task with three outcomes: dropout, still enrolled, or graduated</p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>Multiclass: Both data set cater a multi class problems with <code>NObeyesdad</code> and <code>Target</code> columns</li>
<li>Mixed Data Type: A good mix of categorical and continuous variables are available for usage.</li>
<li>Sizeable: More than 2 K rows are available for testing.</li>
</ul>
</section>
</section>
<section id="exploratory-data-analysis-eda-setting-the-stage" class="level1 page-columns page-full">
<h1>Exploratory Data Analysis (EDA): Setting the Stage</h1>
<p>Before we dive into model creation, let’s explore our dataset through some quick EDA. Think of this as getting to know your non-obese friends before inviting them to a party.</p>
<section id="eda-for-obesity-data" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="eda-for-obesity-data">EDA for Obesity Data</h3>
<p>Here’s a brief code snippet to perform essential EDA on the Obesity dataset:</p>
<div id="640ef0e8" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Loading data and generating basic descriptive</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load the Obesity data</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>raw_df <span class="op">=</span> pd.read_csv(<span class="st">'ObesityDataSet_raw_and_data_sinthetic.csv'</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>target <span class="op">=</span> <span class="st">'NObeyesdad'</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># Load Students data</span></span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Load Credit data</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># raw_data = sm.datasets.get_rdataset("credit_data",'modeldata')</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># raw_df = raw_data.data</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># target = 'Status'</span></span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># # Load Palmer penguins data</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># raw_data = sm.datasets.get_rdataset("penguins",'palmerpenguins')</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co"># raw_df = raw_data.data</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># target = 'species'</span></span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># # Load Credit data</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># raw_data = sm.datasets.get_rdataset("CreditCard",'AER')</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co"># raw_df = raw_data.data</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co"># target = 'card'</span></span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co"># setting things up for aal the next steps</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>raw_df[target] <span class="op">=</span> raw_df[target].astype(<span class="st">'category'</span>) </span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="bu">print</span>(<span class="st">'No of data points available to work:'</span>,raw_df.shape)</span>
<span id="cb1-27"><a href="#cb1-27"></a>display(raw_df.head())</span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co"># Summary statistics</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>display(raw_df.describe())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>No of data points available to work: (2111, 17)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Gender</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">Famil_Hist_Owt</th>
<th data-quarto-table-cell-role="th">FAVC</th>
<th data-quarto-table-cell-role="th">FCVC</th>
<th data-quarto-table-cell-role="th">NCP</th>
<th data-quarto-table-cell-role="th">CAEC</th>
<th data-quarto-table-cell-role="th">SMOKE</th>
<th data-quarto-table-cell-role="th">CH2O</th>
<th data-quarto-table-cell-role="th">SCC</th>
<th data-quarto-table-cell-role="th">FAF</th>
<th data-quarto-table-cell-role="th">TUE</th>
<th data-quarto-table-cell-role="th">CALC</th>
<th data-quarto-table-cell-role="th">MTRANS</th>
<th data-quarto-table-cell-role="th">NObeyesdad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>Female</td>
<td>21.0</td>
<td>1.62</td>
<td>64.0</td>
<td>yes</td>
<td>no</td>
<td>2.0</td>
<td>3.0</td>
<td>Sometimes</td>
<td>no</td>
<td>2.0</td>
<td>no</td>
<td>0.0</td>
<td>1.0</td>
<td>no</td>
<td>Public_Transportation</td>
<td>Normal_Weight</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>Female</td>
<td>21.0</td>
<td>1.52</td>
<td>56.0</td>
<td>yes</td>
<td>no</td>
<td>3.0</td>
<td>3.0</td>
<td>Sometimes</td>
<td>yes</td>
<td>3.0</td>
<td>yes</td>
<td>3.0</td>
<td>0.0</td>
<td>Sometimes</td>
<td>Public_Transportation</td>
<td>Normal_Weight</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Male</td>
<td>23.0</td>
<td>1.80</td>
<td>77.0</td>
<td>yes</td>
<td>no</td>
<td>2.0</td>
<td>3.0</td>
<td>Sometimes</td>
<td>no</td>
<td>2.0</td>
<td>no</td>
<td>2.0</td>
<td>1.0</td>
<td>Frequently</td>
<td>Public_Transportation</td>
<td>Normal_Weight</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Male</td>
<td>27.0</td>
<td>1.80</td>
<td>87.0</td>
<td>no</td>
<td>no</td>
<td>3.0</td>
<td>3.0</td>
<td>Sometimes</td>
<td>no</td>
<td>2.0</td>
<td>no</td>
<td>2.0</td>
<td>0.0</td>
<td>Frequently</td>
<td>Walking</td>
<td>Overweight_Level_I</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Male</td>
<td>22.0</td>
<td>1.78</td>
<td>89.8</td>
<td>no</td>
<td>no</td>
<td>2.0</td>
<td>1.0</td>
<td>Sometimes</td>
<td>no</td>
<td>2.0</td>
<td>no</td>
<td>0.0</td>
<td>0.0</td>
<td>Sometimes</td>
<td>Public_Transportation</td>
<td>Overweight_Level_II</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">Height</th>
<th data-quarto-table-cell-role="th">Weight</th>
<th data-quarto-table-cell-role="th">FCVC</th>
<th data-quarto-table-cell-role="th">NCP</th>
<th data-quarto-table-cell-role="th">CH2O</th>
<th data-quarto-table-cell-role="th">FAF</th>
<th data-quarto-table-cell-role="th">TUE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">count</th>
<td>2111.000000</td>
<td>2111.000000</td>
<td>2111.000000</td>
<td>2111.000000</td>
<td>2111.000000</td>
<td>2111.000000</td>
<td>2111.000000</td>
<td>2111.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">mean</th>
<td>24.312600</td>
<td>1.701677</td>
<td>86.586058</td>
<td>2.419043</td>
<td>2.685628</td>
<td>2.008011</td>
<td>1.010298</td>
<td>0.657866</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">std</th>
<td>6.345968</td>
<td>0.093305</td>
<td>26.191172</td>
<td>0.533927</td>
<td>0.778039</td>
<td>0.612953</td>
<td>0.850592</td>
<td>0.608927</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">min</th>
<td>14.000000</td>
<td>1.450000</td>
<td>39.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25%</th>
<td>19.947192</td>
<td>1.630000</td>
<td>65.473343</td>
<td>2.000000</td>
<td>2.658738</td>
<td>1.584812</td>
<td>0.124505</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">50%</th>
<td>22.777890</td>
<td>1.700499</td>
<td>83.000000</td>
<td>2.385502</td>
<td>3.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>0.625350</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">75%</th>
<td>26.000000</td>
<td>1.768464</td>
<td>107.430682</td>
<td>3.000000</td>
<td>3.000000</td>
<td>2.477420</td>
<td>1.666678</td>
<td>1.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">max</th>
<td>61.000000</td>
<td>1.980000</td>
<td>173.000000</td>
<td>3.000000</td>
<td>4.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>2.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p><em>Target distribution</em></p>
<div id="1c835f13" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Target and Correlation</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Visualize target data distribution</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>sns.countplot(data<span class="op">=</span>raw_df, x<span class="op">=</span>target, hue<span class="op">=</span>target, palette<span class="op">=</span><span class="st">'Set2'</span>,)</span>
<span id="cb3-4"><a href="#cb3-4"></a>plt.title(<span class="ss">f'Distribution of </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> levels'</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>plt.show()</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co"># Heatmap to check for correlations between numeric variables</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>corr <span class="op">=</span> raw_df.corr(<span class="st">'kendall'</span>,numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>sns.heatmap(corr, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">'coolwarm'</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a>plt.title(<span class="st">'Kendall Correlation Heatmap'</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-4-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/cell-4-output-1.png" width="392" height="382" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-4-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/cell-4-output-2.png" width="537" height="430" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Some Mode EDA for the data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="4d6286b8" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>EDA code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Visualize the distribution of numerical variables</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>sns.pairplot(raw_df, hue<span class="op">=</span>target, corner<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>plt.show()</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># Gettign Categorical data</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>categorical_columns <span class="op">=</span> raw_df.select_dtypes(include<span class="op">=</span><span class="st">'object'</span>).columns</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># Plot categorical variables with respect to the target variable</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb4-13"><a href="#cb4-13"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb4-14"><a href="#cb4-14"></a>    sns.countplot(data<span class="op">=</span>raw_df,x<span class="op">=</span>col, hue<span class="op">=</span>target)</span>
<span id="cb4-15"><a href="#cb4-15"></a>    plt.title(<span class="ss">f"Countplot of </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss"> with respect to </span><span class="sc">{</span>target<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-16"><a href="#cb4-16"></a>    plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/cell-5-output-1.png" width="2075" height="1887" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/cell-5-output-2.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index_files/figure-html/cell-5-output-3.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="index_files/figure-html/cell-5-output-4.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="index_files/figure-html/cell-5-output-5.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="index_files/figure-html/cell-5-output-6.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="index_files/figure-html/cell-5-output-7.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="index_files/figure-html/cell-5-output-8.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-9.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="index_files/figure-html/cell-5-output-9.png" width="961" height="447" class="figure-img img-fluid"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div></div></section>
</section>
<section id="model-creation-establishing-a-baseline" class="level1 page-columns page-full">
<h1>Model Creation: Establishing a Baseline</h1>
<p>With our exploratory analysis complete, we’re ready to create our baseline model using logistic regression with Statsmodels. This initial model will serve as our reference point—like setting up a benchmark for your favorite video game.</p>
<div id="876b6fcc" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Splitting data and training a default Multinomila Logit model on our data</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>data_df <span class="op">=</span> raw_df.dropna().reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>data_df[target] <span class="op">=</span> data_df[target].cat.codes</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># X = data_df[['bill_length_mm','bill_depth_mm','flipper_length_mm','body_mass_g']] </span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>data_df_test <span class="op">=</span> data_df.sample(frac<span class="op">=</span><span class="fl">0.1</span>,random_state<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>data_df_train <span class="op">=</span> data_df.drop(data_df_test.index)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co"># Using MN logistic regression model using formula API</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># This would essentially bold down to pair wise logsitic regression</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>logit_model <span class="op">=</span> sm.MNLogit.from_formula(</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="ss">f"</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> ~ </span><span class="sc">{</span><span class="st">' + '</span><span class="sc">.</span>join([col <span class="cf">for</span> col <span class="kw">in</span> data_df_train.columns <span class="cf">if</span> col <span class="op">!=</span> target])<span class="sc">}</span><span class="ss">"</span>, </span>
<span id="cb5-12"><a href="#cb5-12"></a>    data<span class="op">=</span>data_df_train</span>
<span id="cb5-13"><a href="#cb5-13"></a>).fit_regularized()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully    (Exit mode 0)
            Current function value: 0.17057119619320013
            Iterations: 485
            Function evaluations: 639
            Gradient evaluations: 485</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Base model summary for geeks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="c70fd1f5" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Display summary</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>display(logit_model.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<table class="simpletable table table-sm table-striped small">
<caption>MNLogit Regression Results</caption>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dep. Variable:</th>
<td>NObeyesdad</td>
<th data-quarto-table-cell-role="th">No. Observations:</th>
<td>1900</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Model:</th>
<td>MNLogit</td>
<th data-quarto-table-cell-role="th">Df Residuals:</th>
<td>1756</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Method:</th>
<td>MLE</td>
<th data-quarto-table-cell-role="th">Df Model:</th>
<td>138</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Date:</th>
<td>Mon, 15 Dec 2025</td>
<th data-quarto-table-cell-role="th">Pseudo R-squ.:</th>
<td>0.9122</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Time:</th>
<td>16:07:33</td>
<th data-quarto-table-cell-role="th">Log-Likelihood:</th>
<td>-324.09</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">converged:</th>
<td>True</td>
<th data-quarto-table-cell-role="th">LL-Null:</th>
<td>-3691.8</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Covariance Type:</th>
<td>nonrobust</td>
<th data-quarto-table-cell-role="th">LLR p-value:</th>
<td>0.000</td>
</tr>
</tbody>
</table>


<table class="simpletable table table-sm table-striped small">
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=1</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-11.2903</td>
<td>3.25e+05</td>
<td>-3.48e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Gender[T.Male]</th>
<td>-3.4851</td>
<td>0.817</td>
<td>-4.268</td>
<td>0.000</td>
<td>-5.085</td>
<td>-1.885</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Famil_Hist_Owt[T.yes]</th>
<td>-0.8162</td>
<td>0.655</td>
<td>-1.246</td>
<td>0.213</td>
<td>-2.100</td>
<td>0.468</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAVC[T.yes]</th>
<td>0.2636</td>
<td>0.785</td>
<td>0.336</td>
<td>0.737</td>
<td>-1.275</td>
<td>1.802</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.Frequently]</th>
<td>-8.2402</td>
<td>2.312</td>
<td>-3.564</td>
<td>0.000</td>
<td>-12.771</td>
<td>-3.709</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.Sometimes]</th>
<td>-6.2226</td>
<td>2.232</td>
<td>-2.787</td>
<td>0.005</td>
<td>-10.598</td>
<td>-1.847</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.no]</th>
<td>-8.5977</td>
<td>2.889</td>
<td>-2.976</td>
<td>0.003</td>
<td>-14.260</td>
<td>-2.935</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SMOKE[T.yes]</th>
<td>4.4919</td>
<td>3.115</td>
<td>1.442</td>
<td>0.149</td>
<td>-1.614</td>
<td>10.598</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">SCC[T.yes]</th>
<td>-0.7294</td>
<td>1.447</td>
<td>-0.504</td>
<td>0.614</td>
<td>-3.565</td>
<td>2.106</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.Frequently]</th>
<td>-12.6192</td>
<td>3.25e+05</td>
<td>-3.89e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.Sometimes]</th>
<td>-13.2985</td>
<td>3.25e+05</td>
<td>-4.1e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.no]</th>
<td>-14.1585</td>
<td>3.25e+05</td>
<td>-4.36e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Bike]</th>
<td>15.8909</td>
<td>2489.580</td>
<td>0.006</td>
<td>0.995</td>
<td>-4863.596</td>
<td>4895.378</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Motorbike]</th>
<td>3.9944</td>
<td>47.659</td>
<td>0.084</td>
<td>0.933</td>
<td>-89.416</td>
<td>97.405</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Public_Transportation]</th>
<td>4.4914</td>
<td>0.995</td>
<td>4.514</td>
<td>0.000</td>
<td>2.541</td>
<td>6.441</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Walking]</th>
<td>4.3554</td>
<td>1.502</td>
<td>2.900</td>
<td>0.004</td>
<td>1.412</td>
<td>7.299</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.3721</td>
<td>0.097</td>
<td>3.833</td>
<td>0.000</td>
<td>0.182</td>
<td>0.562</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-14.4208</td>
<td>4.118</td>
<td>-3.502</td>
<td>0.000</td>
<td>-22.492</td>
<td>-6.349</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>1.0786</td>
<td>0.146</td>
<td>7.378</td>
<td>0.000</td>
<td>0.792</td>
<td>1.365</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FCVC</th>
<td>-0.7754</td>
<td>0.429</td>
<td>-1.806</td>
<td>0.071</td>
<td>-1.617</td>
<td>0.066</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">NCP</th>
<td>-1.7094</td>
<td>0.491</td>
<td>-3.480</td>
<td>0.001</td>
<td>-2.672</td>
<td>-0.747</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-1.7291</td>
<td>0.578</td>
<td>-2.992</td>
<td>0.003</td>
<td>-2.862</td>
<td>-0.596</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-0.1924</td>
<td>0.280</td>
<td>-0.688</td>
<td>0.491</td>
<td>-0.740</td>
<td>0.356</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-0.9320</td>
<td>0.456</td>
<td>-2.043</td>
<td>0.041</td>
<td>-1.826</td>
<td>-0.038</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">NObeyesdad=2</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>17.4309</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Gender[T.Male]</th>
<td>-14.0384</td>
<td>1.983</td>
<td>-7.079</td>
<td>0.000</td>
<td>-17.925</td>
<td>-10.151</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Famil_Hist_Owt[T.yes]</th>
<td>2.0527</td>
<td>1.717</td>
<td>1.195</td>
<td>0.232</td>
<td>-1.313</td>
<td>5.418</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FAVC[T.yes]</th>
<td>0.9668</td>
<td>1.752</td>
<td>0.552</td>
<td>0.581</td>
<td>-2.468</td>
<td>4.401</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.Frequently]</th>
<td>-10.0052</td>
<td>4.352</td>
<td>-2.299</td>
<td>0.021</td>
<td>-18.534</td>
<td>-1.476</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.Sometimes]</th>
<td>-1.0074</td>
<td>3.427</td>
<td>-0.294</td>
<td>0.769</td>
<td>-7.724</td>
<td>5.709</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.no]</th>
<td>-0.4896</td>
<td>894.479</td>
<td>-0.001</td>
<td>1.000</td>
<td>-1753.637</td>
<td>1752.658</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">SMOKE[T.yes]</th>
<td>8.1410</td>
<td>4.013</td>
<td>2.029</td>
<td>0.042</td>
<td>0.277</td>
<td>16.005</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SCC[T.yes]</th>
<td>-7.6940</td>
<td>152.983</td>
<td>-0.050</td>
<td>0.960</td>
<td>-307.535</td>
<td>292.147</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.Frequently]</th>
<td>-2.4516</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.Sometimes]</th>
<td>-7.5316</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.no]</th>
<td>-7.2301</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Bike]</th>
<td>-11.9350</td>
<td>8.09e+07</td>
<td>-1.47e-07</td>
<td>1.000</td>
<td>-1.59e+08</td>
<td>1.59e+08</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Motorbike]</th>
<td>10.9226</td>
<td>48.493</td>
<td>0.225</td>
<td>0.822</td>
<td>-84.123</td>
<td>105.968</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Public_Transportation]</th>
<td>11.1756</td>
<td>1.750</td>
<td>6.387</td>
<td>0.000</td>
<td>7.746</td>
<td>14.605</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Walking]</th>
<td>1.7281</td>
<td>2.759</td>
<td>0.626</td>
<td>0.531</td>
<td>-3.679</td>
<td>7.135</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.8111</td>
<td>0.132</td>
<td>6.139</td>
<td>0.000</td>
<td>0.552</td>
<td>1.070</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Height</th>
<td>-184.0385</td>
<td>14.746</td>
<td>-12.481</td>
<td>0.000</td>
<td>-212.939</td>
<td>-155.138</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Weight</th>
<td>3.9438</td>
<td>0.288</td>
<td>13.688</td>
<td>0.000</td>
<td>3.379</td>
<td>4.508</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FCVC</th>
<td>0.8915</td>
<td>1.014</td>
<td>0.879</td>
<td>0.379</td>
<td>-1.095</td>
<td>2.878</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NCP</th>
<td>-1.1415</td>
<td>0.711</td>
<td>-1.605</td>
<td>0.109</td>
<td>-2.536</td>
<td>0.253</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-1.5390</td>
<td>0.876</td>
<td>-1.756</td>
<td>0.079</td>
<td>-3.256</td>
<td>0.179</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-1.5295</td>
<td>0.591</td>
<td>-2.586</td>
<td>0.010</td>
<td>-2.689</td>
<td>-0.370</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-0.5710</td>
<td>0.840</td>
<td>-0.680</td>
<td>0.497</td>
<td>-2.217</td>
<td>1.075</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=3</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-138.5068</td>
<td>1.47e+07</td>
<td>-9.41e-06</td>
<td>1.000</td>
<td>-2.89e+07</td>
<td>2.89e+07</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Gender[T.Male]</th>
<td>-16.6365</td>
<td>8.279</td>
<td>-2.010</td>
<td>0.044</td>
<td>-32.863</td>
<td>-0.410</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Famil_Hist_Owt[T.yes]</th>
<td>2.3538</td>
<td>11.601</td>
<td>0.203</td>
<td>0.839</td>
<td>-20.384</td>
<td>25.092</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAVC[T.yes]</th>
<td>-8.7785</td>
<td>5.476</td>
<td>-1.603</td>
<td>0.109</td>
<td>-19.512</td>
<td>1.955</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.Frequently]</th>
<td>-71.7022</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.Sometimes]</th>
<td>-3.9034</td>
<td>4.734</td>
<td>-0.824</td>
<td>0.410</td>
<td>-13.183</td>
<td>5.376</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.no]</th>
<td>7.7265</td>
<td>895.063</td>
<td>0.009</td>
<td>0.993</td>
<td>-1746.566</td>
<td>1762.019</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SMOKE[T.yes]</th>
<td>3.5306</td>
<td>19.342</td>
<td>0.183</td>
<td>0.855</td>
<td>-34.379</td>
<td>41.440</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">SCC[T.yes]</th>
<td>-19.4879</td>
<td>154.607</td>
<td>-0.126</td>
<td>0.900</td>
<td>-322.512</td>
<td>283.536</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.Frequently]</th>
<td>-43.6020</td>
<td>1.48e+07</td>
<td>-2.95e-06</td>
<td>1.000</td>
<td>-2.9e+07</td>
<td>2.9e+07</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.Sometimes]</th>
<td>-45.7496</td>
<td>1.47e+07</td>
<td>-3.11e-06</td>
<td>1.000</td>
<td>-2.88e+07</td>
<td>2.88e+07</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.no]</th>
<td>-28.2183</td>
<td>1.43e+07</td>
<td>-1.97e-06</td>
<td>1.000</td>
<td>-2.81e+07</td>
<td>2.81e+07</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Bike]</th>
<td>0.0376</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Motorbike]</th>
<td>-2.3812</td>
<td>1.05e+11</td>
<td>-2.27e-11</td>
<td>1.000</td>
<td>-2.06e+11</td>
<td>2.06e+11</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Public_Transportation]</th>
<td>22.5234</td>
<td>6.664</td>
<td>3.380</td>
<td>0.001</td>
<td>9.463</td>
<td>35.584</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Walking]</th>
<td>-5.3334</td>
<td>33.279</td>
<td>-0.160</td>
<td>0.873</td>
<td>-70.560</td>
<td>59.893</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>2.5106</td>
<td>0.964</td>
<td>2.605</td>
<td>0.009</td>
<td>0.621</td>
<td>4.400</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-278.9439</td>
<td>44.201</td>
<td>-6.311</td>
<td>0.000</td>
<td>-365.576</td>
<td>-192.312</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>7.1539</td>
<td>1.394</td>
<td>5.132</td>
<td>0.000</td>
<td>4.422</td>
<td>9.886</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FCVC</th>
<td>4.1064</td>
<td>3.285</td>
<td>1.250</td>
<td>0.211</td>
<td>-2.333</td>
<td>10.546</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">NCP</th>
<td>-1.5637</td>
<td>2.424</td>
<td>-0.645</td>
<td>0.519</td>
<td>-6.315</td>
<td>3.187</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-13.4088</td>
<td>5.560</td>
<td>-2.412</td>
<td>0.016</td>
<td>-24.306</td>
<td>-2.511</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-9.8534</td>
<td>4.356</td>
<td>-2.262</td>
<td>0.024</td>
<td>-18.390</td>
<td>-1.316</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-5.6951</td>
<td>3.292</td>
<td>-1.730</td>
<td>0.084</td>
<td>-12.147</td>
<td>0.757</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">NObeyesdad=4</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-87.3214</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Gender[T.Male]</th>
<td>-200.3037</td>
<td>5.41e+07</td>
<td>-3.7e-06</td>
<td>1.000</td>
<td>-1.06e+08</td>
<td>1.06e+08</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Famil_Hist_Owt[T.yes]</th>
<td>-30.9252</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FAVC[T.yes]</th>
<td>-53.1818</td>
<td>3.98e+07</td>
<td>-1.34e-06</td>
<td>1.000</td>
<td>-7.8e+07</td>
<td>7.8e+07</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.Frequently]</th>
<td>-28.5483</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.Sometimes]</th>
<td>-21.5821</td>
<td>5.38e+07</td>
<td>-4.01e-07</td>
<td>1.000</td>
<td>-1.05e+08</td>
<td>1.05e+08</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.no]</th>
<td>-2.2000</td>
<td>4.62e+29</td>
<td>-4.76e-30</td>
<td>1.000</td>
<td>-9.06e+29</td>
<td>9.06e+29</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">SMOKE[T.yes]</th>
<td>-6.0944</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SCC[T.yes]</th>
<td>-12.3054</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.Frequently]</th>
<td>-6.2460</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.Sometimes]</th>
<td>-37.2004</td>
<td>2.12e+08</td>
<td>-1.76e-07</td>
<td>1.000</td>
<td>-4.15e+08</td>
<td>4.15e+08</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.no]</th>
<td>-64.5032</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Bike]</th>
<td>-0.2989</td>
<td>1.92e+53</td>
<td>-1.56e-54</td>
<td>1.000</td>
<td>-3.76e+53</td>
<td>3.76e+53</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Motorbike]</th>
<td>-0.2031</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Public_Transportation]</th>
<td>-57.6854</td>
<td>7.04e+07</td>
<td>-8.2e-07</td>
<td>1.000</td>
<td>-1.38e+08</td>
<td>1.38e+08</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Walking]</th>
<td>-7.4464</td>
<td>2.03e+15</td>
<td>-3.66e-15</td>
<td>1.000</td>
<td>-3.98e+15</td>
<td>3.98e+15</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Age</th>
<td>-9.3747</td>
<td>103.246</td>
<td>-0.091</td>
<td>0.928</td>
<td>-211.733</td>
<td>192.984</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Height</th>
<td>-174.4727</td>
<td>592.866</td>
<td>-0.294</td>
<td>0.769</td>
<td>-1336.469</td>
<td>987.523</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Weight</th>
<td>8.7405</td>
<td>35.222</td>
<td>0.248</td>
<td>0.804</td>
<td>-60.293</td>
<td>77.774</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FCVC</th>
<td>49.0613</td>
<td>3.02e+04</td>
<td>0.002</td>
<td>0.999</td>
<td>-5.91e+04</td>
<td>5.92e+04</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NCP</th>
<td>2.3650</td>
<td>4572.743</td>
<td>0.001</td>
<td>1.000</td>
<td>-8960.047</td>
<td>8964.777</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-18.5809</td>
<td>34.347</td>
<td>-0.541</td>
<td>0.589</td>
<td>-85.900</td>
<td>48.738</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-65.1761</td>
<td>262.887</td>
<td>-0.248</td>
<td>0.804</td>
<td>-580.424</td>
<td>450.072</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-44.3721</td>
<td>285.217</td>
<td>-0.156</td>
<td>0.876</td>
<td>-603.387</td>
<td>514.643</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=5</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-12.5683</td>
<td>3.25e+05</td>
<td>-3.87e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Gender[T.Male]</th>
<td>-6.8149</td>
<td>1.085</td>
<td>-6.282</td>
<td>0.000</td>
<td>-8.941</td>
<td>-4.689</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Famil_Hist_Owt[T.yes]</th>
<td>-0.5822</td>
<td>0.790</td>
<td>-0.737</td>
<td>0.461</td>
<td>-2.130</td>
<td>0.966</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAVC[T.yes]</th>
<td>2.6008</td>
<td>0.978</td>
<td>2.660</td>
<td>0.008</td>
<td>0.684</td>
<td>4.517</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.Frequently]</th>
<td>-7.2298</td>
<td>2.507</td>
<td>-2.884</td>
<td>0.004</td>
<td>-12.143</td>
<td>-2.316</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.Sometimes]</th>
<td>-2.8197</td>
<td>2.413</td>
<td>-1.168</td>
<td>0.243</td>
<td>-7.550</td>
<td>1.910</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.no]</th>
<td>-3.8181</td>
<td>3.143</td>
<td>-1.215</td>
<td>0.224</td>
<td>-9.977</td>
<td>2.341</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SMOKE[T.yes]</th>
<td>3.1451</td>
<td>3.296</td>
<td>0.954</td>
<td>0.340</td>
<td>-3.314</td>
<td>9.604</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">SCC[T.yes]</th>
<td>2.1647</td>
<td>1.617</td>
<td>1.339</td>
<td>0.181</td>
<td>-1.004</td>
<td>5.334</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.Frequently]</th>
<td>-9.0315</td>
<td>3.25e+05</td>
<td>-2.78e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.Sometimes]</th>
<td>-9.1446</td>
<td>3.25e+05</td>
<td>-2.82e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.no]</th>
<td>-10.7708</td>
<td>3.25e+05</td>
<td>-3.32e-05</td>
<td>1.000</td>
<td>-6.36e+05</td>
<td>6.36e+05</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Bike]</th>
<td>19.0425</td>
<td>2489.581</td>
<td>0.008</td>
<td>0.994</td>
<td>-4860.446</td>
<td>4898.531</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Motorbike]</th>
<td>1.6235</td>
<td>47.716</td>
<td>0.034</td>
<td>0.973</td>
<td>-91.899</td>
<td>95.146</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Public_Transportation]</th>
<td>5.9777</td>
<td>1.209</td>
<td>4.946</td>
<td>0.000</td>
<td>3.609</td>
<td>8.346</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Walking]</th>
<td>4.3596</td>
<td>1.776</td>
<td>2.454</td>
<td>0.014</td>
<td>0.878</td>
<td>7.841</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.4878</td>
<td>0.106</td>
<td>4.597</td>
<td>0.000</td>
<td>0.280</td>
<td>0.696</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-50.0157</td>
<td>6.721</td>
<td>-7.442</td>
<td>0.000</td>
<td>-63.188</td>
<td>-36.844</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>1.7920</td>
<td>0.168</td>
<td>10.651</td>
<td>0.000</td>
<td>1.462</td>
<td>2.122</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FCVC</th>
<td>-0.8369</td>
<td>0.601</td>
<td>-1.393</td>
<td>0.164</td>
<td>-2.014</td>
<td>0.341</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">NCP</th>
<td>-1.4453</td>
<td>0.554</td>
<td>-2.608</td>
<td>0.009</td>
<td>-2.531</td>
<td>-0.359</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-1.7648</td>
<td>0.679</td>
<td>-2.601</td>
<td>0.009</td>
<td>-3.095</td>
<td>-0.435</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-0.5613</td>
<td>0.374</td>
<td>-1.499</td>
<td>0.134</td>
<td>-1.295</td>
<td>0.172</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-0.7982</td>
<td>0.555</td>
<td>-1.439</td>
<td>0.150</td>
<td>-1.886</td>
<td>0.289</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">NObeyesdad=6</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>-2.1693</td>
<td>6.28e+06</td>
<td>-3.45e-07</td>
<td>1.000</td>
<td>-1.23e+07</td>
<td>1.23e+07</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Gender[T.Male]</th>
<td>-6.6857</td>
<td>1.207</td>
<td>-5.537</td>
<td>0.000</td>
<td>-9.052</td>
<td>-4.319</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Famil_Hist_Owt[T.yes]</th>
<td>1.9296</td>
<td>1.076</td>
<td>1.793</td>
<td>0.073</td>
<td>-0.179</td>
<td>4.038</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FAVC[T.yes]</th>
<td>-0.4617</td>
<td>1.141</td>
<td>-0.405</td>
<td>0.686</td>
<td>-2.698</td>
<td>1.775</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.Frequently]</th>
<td>-5.5324</td>
<td>3.264</td>
<td>-1.695</td>
<td>0.090</td>
<td>-11.930</td>
<td>0.866</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CAEC[T.Sometimes]</th>
<td>0.7854</td>
<td>3.044</td>
<td>0.258</td>
<td>0.796</td>
<td>-5.181</td>
<td>6.752</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CAEC[T.no]</th>
<td>1.7141</td>
<td>3.934</td>
<td>0.436</td>
<td>0.663</td>
<td>-5.997</td>
<td>9.426</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">SMOKE[T.yes]</th>
<td>7.0398</td>
<td>3.570</td>
<td>1.972</td>
<td>0.049</td>
<td>0.043</td>
<td>14.036</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">SCC[T.yes]</th>
<td>1.3664</td>
<td>2.012</td>
<td>0.679</td>
<td>0.497</td>
<td>-2.577</td>
<td>5.309</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.Frequently]</th>
<td>-2.1001</td>
<td>6.28e+06</td>
<td>-3.34e-07</td>
<td>1.000</td>
<td>-1.23e+07</td>
<td>1.23e+07</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CALC[T.Sometimes]</th>
<td>-4.6772</td>
<td>6.28e+06</td>
<td>-7.45e-07</td>
<td>1.000</td>
<td>-1.23e+07</td>
<td>1.23e+07</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CALC[T.no]</th>
<td>-4.1972</td>
<td>6.28e+06</td>
<td>-6.68e-07</td>
<td>1.000</td>
<td>-1.23e+07</td>
<td>1.23e+07</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Bike]</th>
<td>-21.8420</td>
<td>6.54e+09</td>
<td>-3.34e-09</td>
<td>1.000</td>
<td>-1.28e+10</td>
<td>1.28e+10</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Motorbike]</th>
<td>3.2252</td>
<td>47.781</td>
<td>0.068</td>
<td>0.946</td>
<td>-90.423</td>
<td>96.873</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MTRANS[T.Public_Transportation]</th>
<td>8.8055</td>
<td>1.416</td>
<td>6.219</td>
<td>0.000</td>
<td>6.030</td>
<td>11.581</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">MTRANS[T.Walking]</th>
<td>1.2540</td>
<td>2.256</td>
<td>0.556</td>
<td>0.578</td>
<td>-3.168</td>
<td>5.676</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.7030</td>
<td>0.116</td>
<td>6.086</td>
<td>0.000</td>
<td>0.477</td>
<td>0.929</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Height</th>
<td>-104.6838</td>
<td>9.021</td>
<td>-11.605</td>
<td>0.000</td>
<td>-122.364</td>
<td>-87.003</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Weight</th>
<td>2.6259</td>
<td>0.190</td>
<td>13.819</td>
<td>0.000</td>
<td>2.253</td>
<td>2.998</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FCVC</th>
<td>0.1776</td>
<td>0.764</td>
<td>0.232</td>
<td>0.816</td>
<td>-1.320</td>
<td>1.675</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NCP</th>
<td>-1.8276</td>
<td>0.608</td>
<td>-3.007</td>
<td>0.003</td>
<td>-3.019</td>
<td>-0.636</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-1.8930</td>
<td>0.757</td>
<td>-2.502</td>
<td>0.012</td>
<td>-3.376</td>
<td>-0.410</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-1.0280</td>
<td>0.438</td>
<td>-2.347</td>
<td>0.019</td>
<td>-1.887</td>
<td>-0.169</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">TUE</th>
<td>0.1282</td>
<td>0.670</td>
<td>0.191</td>
<td>0.848</td>
<td>-1.186</td>
<td>1.442</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div></div><section id="evaluating-model-performance" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-model-performance">Evaluating Model Performance</h3>
<p>To gauge our models’ effectiveness, we’ll employ various metrics such as accuracy, precision, recall, and F1-score. A confusion matrix will help visualize how well our models perform in classifying outcomes—think of it as a report card for your model!</p>
<div id="411813f4" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Evaluating the Logit model</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>base_preds <span class="op">=</span> logit_model.predict(data_df_test).idxmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>y_test <span class="op">=</span> data_df_test[target]</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># Evaluate the model</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>accuracy_orig <span class="op">=</span> accuracy_score(y_test, base_preds)</span>
<span id="cb8-7"><a href="#cb8-7"></a>report_orig <span class="op">=</span> classification_report(y_test, base_preds)</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="bu">print</span>(<span class="st">"Accuracy:"</span>, accuracy_orig)</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="bu">print</span>(<span class="st">"Classification Report:"</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="bu">print</span>(report_orig)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Accuracy: 0.909952606635071
Classification Report:
              precision    recall  f1-score   support

           0       0.93      0.86      0.89        29
           1       0.86      0.83      0.84        29
           2       0.95      0.91      0.93        45
           3       0.94      0.97      0.95        31
           4       1.00      0.96      0.98        27
           5       0.83      0.90      0.86        21
           6       0.84      0.93      0.89        29

    accuracy                           0.91       211
   macro avg       0.91      0.91      0.91       211
weighted avg       0.91      0.91      0.91       211
</code></pre>
</div>
</div>
</section>
</section>
<section id="looking-for-some-improvments" class="level1 page-columns page-full">
<h1>Looking for some <em>Improvments!</em></h1>
<section id="feature-selection-using-crosstab-sparsity" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="feature-selection-using-crosstab-sparsity">Feature Selection Using CrossTab Sparsity</h3>
<p>Now comes the exciting part—using CrossTab Sparsity to refine our feature selection process! It’s like cleaning up your closet and only keeping the clothes that spark joy (thank you, Marie Kondo). <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;This is based on work in Unique Metric for Health Analysis with Optimization of Clustering Activity and Cross Comparison of Results from Different Approach. <a href="https://arxiv.org/abs/1810.03419">Paper Link</a></p></div></div><p><a href="https://gist.github.com/jkapila/83bb8f6461ec91bfced437762f2c9220">Code is here!</a></p>
</section>
<section id="standared-steps-for-feature-selection" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="standared-steps-for-feature-selection">Standared Steps for Feature Selection</h3>
<ol type="1">
<li><strong>Calculate CrossTab Sparsity</strong>: For each feature against the target variable.</li>
<li><strong>Select Features</strong>: Based on sparsity scores that indicate significant interactions with the target variable.</li>
<li><strong>Recreate Models</strong>: Train new models using only the selected features—less is often more!</li>
</ol>
<p>Here we go!!!</p>
<div class="page-columns page-full">
<div id="b518b716" class="cell page-columns page-full" data-execution_count="9">
<details class="code-fold">
<summary>Doing what needs to Done Code ;)</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>sns.set_style(<span class="st">"white"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>sns.set_context(<span class="st">"paper"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># Calculating Crostab sparsity for each Column</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>results <span class="op">=</span> crosstab_sparsity(data_df_train.iloc[:,:<span class="op">-</span><span class="dv">1</span>],data_df_train[target],numeric_bin<span class="op">=</span><span class="st">'decile'</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co"># presenting results for consumption</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>df_long <span class="op">=</span> pd.melt(results[<span class="st">'scores'</span>], id_vars<span class="op">=</span>[<span class="st">'Columns'</span>], value_vars<span class="op">=</span>[<span class="st">'seggregation'</span>, <span class="st">'explaination'</span>, <span class="st">'metric'</span>],</span>
<span id="cb10-8"><a href="#cb10-8"></a>                  var_name<span class="op">=</span><span class="st">'Metric'</span>, value_name<span class="op">=</span><span class="st">'values'</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># Adding jitter: small random noise to 'Columns' (x-axis)</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co"># df_long['values_jittered'] = df_long['Value'] + np.random.uniform(-0.1, 0.1, size=len(df_long))</span></span>
<span id="cb10-12"><a href="#cb10-12"></a></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co"># Create a seaborn scatter plot with jitter, more professional color palette, and transparency</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb10-15"><a href="#cb10-15"></a>sns.scatterplot(x<span class="op">=</span><span class="st">'Columns'</span>, y<span class="op">=</span><span class="st">'values'</span>, hue<span class="op">=</span><span class="st">'Metric'</span>, style<span class="op">=</span><span class="st">'Metric'</span>,</span>
<span id="cb10-16"><a href="#cb10-16"></a>        data<span class="op">=</span>df_long, s<span class="op">=</span><span class="dv">100</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, palette<span class="op">=</span><span class="st">'deep'</span>)</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co"># Title and labels</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>plt.title(<span class="st">'Metrics by Columns'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>) </span>
<span id="cb10-21"><a href="#cb10-21"></a>plt.xlabel(<span class="st">'Columns'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a>plt.ylabel(<span class="st">'Value'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># Display legend outside the plot for better readability</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>plt.legend(title<span class="op">=</span><span class="st">'Metric'</span>, loc<span class="op">=</span><span class="st">'upper right'</span>, fancybox<span class="op">=</span><span class="va">True</span>, framealpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb10-26"><a href="#cb10-26"></a></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co"># Show the plot</span></span>
<span id="cb10-28"><a href="#cb10-28"></a>plt.tight_layout()</span>
<span id="cb10-29"><a href="#cb10-29"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CSP calculated with decile for breaks!

Scores for 7 groups(s) is : 140.96057955229762</code></pre>
</div>
<div class="cell-output cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><a href="index_files/figure-html/cell-10-output-2.png" class="lightbox page-columns page-full" data-gallery="quarto-lightbox-gallery-13"><img src="index_files/figure-html/cell-10-output-2.png" width="1143" height="472" class="figure-img column-page-right"></a></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="and-drum-rolls-pelase" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="and-drum-rolls-pelase">And Drum Rolls pelase!!!</h3>
<p>Using just top 5 varaibles we are getting almost similar or better overall accuracy. This amounts to greatly simplifing the models and clearly explain why some variable are not useful for modeling.</p>
<div id="f36616a7" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>And finally training and evaluating with drum rolls</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>logit_model_rev <span class="op">=</span> sm.MNLogit.from_formula(<span class="ss">f"</span><span class="sc">{</span>target<span class="sc">}</span><span class="ss"> ~ </span><span class="sc">{</span><span class="st">' + '</span><span class="sc">.</span>join(results[<span class="st">'scores'</span>].loc[:<span class="dv">5</span>,<span class="st">'Columns'</span>].values)<span class="sc">}</span><span class="ss">"</span>, </span>
<span id="cb12-2"><a href="#cb12-2"></a>    data<span class="op">=</span>data_df_train</span>
<span id="cb12-3"><a href="#cb12-3"></a>).fit_regularized()</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Predict on test data</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>challenger_preds <span class="op">=</span> logit_model_rev.predict(data_df_test).idxmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>y_test <span class="op">=</span> data_df_test[target]</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># Evaluate the model</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>accuracy_new <span class="op">=</span> accuracy_score(y_test, challenger_preds)</span>
<span id="cb12-11"><a href="#cb12-11"></a>report_new <span class="op">=</span> classification_report(y_test, challenger_preds)</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="bu">print</span>(<span class="st">"Accuracy:"</span>, accuracy_new)</span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="bu">print</span>(<span class="st">"Classification Report:"</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="bu">print</span>(report_new)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Singular matrix E in LSQ subproblem    (Exit mode 5)
            Current function value: nan
            Iterations: 470
            Function evaluations: 1227
            Gradient evaluations: 470
Accuracy: 0.9383886255924171
Classification Report:
              precision    recall  f1-score   support

           0       0.93      0.97      0.95        29
           1       0.93      0.93      0.93        29
           2       0.96      1.00      0.98        45
           3       0.93      0.90      0.92        31
           4       0.93      0.93      0.93        27
           5       0.90      0.90      0.90        21
           6       0.96      0.90      0.93        29

    accuracy                           0.94       211
   macro avg       0.94      0.93      0.93       211
weighted avg       0.94      0.94      0.94       211
</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/jitin/Documents/applications/perceptions/.venv/lib/python3.12/site-packages/statsmodels/base/model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">None</span>Summary of retrained model
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="4036574f" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>display(logit_model_rev.summary())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<table class="simpletable table table-sm table-striped small">
<caption>MNLogit Regression Results</caption>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Dep. Variable:</th>
<td>NObeyesdad</td>
<th data-quarto-table-cell-role="th">No. Observations:</th>
<td>1900</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Model:</th>
<td>MNLogit</td>
<th data-quarto-table-cell-role="th">Df Residuals:</th>
<td>1858</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Method:</th>
<td>MLE</td>
<th data-quarto-table-cell-role="th">Df Model:</th>
<td>36</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Date:</th>
<td>Mon, 15 Dec 2025</td>
<th data-quarto-table-cell-role="th">Pseudo R-squ.:</th>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Time:</th>
<td>16:07:34</td>
<th data-quarto-table-cell-role="th">Log-Likelihood:</th>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">converged:</th>
<td>False</td>
<th data-quarto-table-cell-role="th">LL-Null:</th>
<td>-3691.8</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Covariance Type:</th>
<td>nonrobust</td>
<th data-quarto-table-cell-role="th">LLR p-value:</th>
<td>nan</td>
</tr>
</tbody>
</table>


<table class="simpletable table table-sm table-striped small">
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=1</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>58.1248</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>0.1130</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-0.8634</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>0.1425</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.0579</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-76.5735</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>1.3337</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=2</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>328.4616</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>2.2275</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-1.4150</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-1.3585</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.1537</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-426.3945</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>5.3584</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=3</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>306.6447</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-7.8630</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-21.0118</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-11.3624</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>2.4017</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-710.3867</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>10.1072</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=4</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>352.4249</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>-9.2469</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-20.6780</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-14.7525</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>2.1487</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-758.2318</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>10.5011</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=5</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>126.2892</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>0.5832</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-0.8764</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-0.1920</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.0719</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-160.2982</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>2.3663</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">NObeyesdad=6</th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">std err</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">P&gt;|z|</th>
<th data-quarto-table-cell-role="th">[0.025</th>
<th data-quarto-table-cell-role="th">0.975]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Intercept</th>
<td>207.3760</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">TUE</th>
<td>1.6561</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CH2O</th>
<td>-0.6583</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FAF</th>
<td>-0.1243</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Age</th>
<td>0.1042</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Height</th>
<td>-266.6050</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Weight</th>
<td>3.6160</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
<td>nan</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div></div></section>
</section>
<section id="impact-on-model-accuracy" class="level1">
<h1>Impact on Model Accuracy</h1>
<p>After applying feature selection based on CrossTab Sparsity, we’ll compare the accuracy of our new models against our baseline models. This comparison will reveal how effectively CrossTab Sparsity enhances classification performance.</p>
<section id="results-and-discussion-unveiling-insights" class="level3">
<h3 class="anchored" data-anchor-id="results-and-discussion-unveiling-insights">Results and Discussion: Unveiling Insights</h3>
<p><strong>Model Comparison Table</strong></p>
<p>After implementing CrossTab Sparsity in our feature selection process, let’s take a look at the results:</p>
<div id="a65aefae" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Comparision Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>metrics <span class="op">=</span> {</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="st">"Metric"</span>: [<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1-Score"</span>],</span>
<span id="cb16-3"><a href="#cb16-3"></a>    <span class="st">"Baseline Model with all Parameters"</span>: [</span>
<span id="cb16-4"><a href="#cb16-4"></a>        accuracy_score(y_test, base_preds),</span>
<span id="cb16-5"><a href="#cb16-5"></a>        precision_score(y_test, base_preds, average<span class="op">=</span><span class="st">'weighted'</span>),</span>
<span id="cb16-6"><a href="#cb16-6"></a>        recall_score(y_test, base_preds, average<span class="op">=</span><span class="st">'weighted'</span>),</span>
<span id="cb16-7"><a href="#cb16-7"></a>        f1_score(y_test, base_preds, average<span class="op">=</span><span class="st">'weighted'</span>),</span>
<span id="cb16-8"><a href="#cb16-8"></a>    ],</span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="st">"Challenger Model with only 5 Variables"</span>: [</span>
<span id="cb16-10"><a href="#cb16-10"></a>        accuracy_score(y_test, challenger_preds),</span>
<span id="cb16-11"><a href="#cb16-11"></a>        precision_score(y_test, challenger_preds, average<span class="op">=</span><span class="st">'weighted'</span>),</span>
<span id="cb16-12"><a href="#cb16-12"></a>        recall_score(y_test, challenger_preds, average<span class="op">=</span><span class="st">'weighted'</span>),</span>
<span id="cb16-13"><a href="#cb16-13"></a>        f1_score(y_test, challenger_preds, average<span class="op">=</span><span class="st">'weighted'</span>),</span>
<span id="cb16-14"><a href="#cb16-14"></a>    ]</span>
<span id="cb16-15"><a href="#cb16-15"></a>}</span>
<span id="cb16-16"><a href="#cb16-16"></a>display(pd.DataFrame(metrics).<span class="bu">round</span>(<span class="dv">4</span>).set_index(<span class="st">'Metric'</span>).T)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Metric</th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">F1-Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">Baseline Model with all Parameters</th>
<td>0.9100</td>
<td>0.9123</td>
<td>0.9100</td>
<td>0.9103</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Challenger Model with only 5 Variables</th>
<td>0.9384</td>
<td>0.9384</td>
<td>0.9384</td>
<td>0.9381</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Insights Gained</strong></p>
<p>Through this analysis, several key insights emerge:</p>
<div id="935b2859" class="cell" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>Reduction of similar accuracy from 16 to 5 i.e 68.75% reduction</code></pre>
</div>
</div>
<ol type="1">
<li><strong>Feature Interactions Matter</strong>: The selected features based on CrossTab Sparsity significantly improved model accuracy—like finding out which ingredients make your favorite dish even better!</li>
<li><strong>Simplicity is Key</strong>: By focusing on relevant features, we enhance accuracy while simplifying model interpretation—because nobody likes unnecessary complexity.</li>
<li><strong>Real-World Applications</strong>: These findings have practical implications in fields such as environmental science where classification plays a critical role—helping us make better decisions for our planet.</li>
</ol>
</section>
</section>
<section id="conclusion-the-road-ahead" class="level1">
<h1>Conclusion: The Road Ahead</h1>
<p>In conclusion, this blog has illustrated how CrossTab Sparsity can be a game-changer in classification tasks using the Obesity dataset. By leveraging this metric for feature selection, we achieved notable improvements in model performance—proof that sometimes less really is more!</p>
<p><strong>Future Work: Expanding Horizons</strong></p>
<p>As we look ahead, there are exciting avenues to explore:</p>
<ul>
<li>Investigating regression problems using CrossTab Sparsity.</li>
<li>Comparing its effectiveness with other feature selection methods such as Recursive Feature Elimination (RFE) or comparision with other feature selection mehtods.</li>
</ul>
<p>By continuing this journey into data science, we not only enhance our technical skills but also contribute valuable insights that can drive meaningful change in various industries.</p>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jitinkapila\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="jkapila/perceptions" issue-term="url" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2026 Jitin Kapila - All rights reserved</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/jitinkapila">
      <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://aicrosscurrent.substack.com/">
      <i class="bi bi-substack" role="img" aria-label="Substack Newsletter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jkapila">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/jitinkapila">
      <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/@jitinkapila">
      <i class="bi bi-youtube" role="img" aria-label="YouTube">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://instagram.com/jitinkapila">
      <i class="bi bi-instagram" role="img" aria-label="Instagram">
</i> 
    </a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../contact.html">
<p>Contact</p>
</a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../../blog/index.xml">
      <i class="bi bi-rss" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>